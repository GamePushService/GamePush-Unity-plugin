# PRODUCT fragment
fragment ProductFields on Product {
    id
    icon
    iconSmall
    tag
    price
    isSubscription
    period
    trialPeriod
    currency
    currencySymbol
    yandexId
    xsollaId
}

# PRODUCT_RESOLVERS fragment
fragment ProductResolvers on Product {
    name(lang: $lang)
    description(lang: $lang)
    iconSmall: icon(w: 48, h: 48, crop: false)
}

# PLAYER_PURCHASE fragment
fragment PlayerPurchaseFields on PlayerPurchase {
    _id
    productId
    payload
    gift
    subscribed
    createdAt
    orderStatus
    expiredAt
}

# PURCHASE_OUTPUT fragment
fragment PurchaseOutput on PurchaseResult {
    __typename
    ... on Problem { message }
    ... on PlayerPurchaseOutput {
        product {
            ...ProductFields
            ...ProductResolvers
        }
        purchase {
            ...PlayerPurchaseFields
        }
    }
}


# CONSUME_PRODUCT mutation
mutation result($input: ConsumePlayerPurchaseInput!, $lang: Lang) {
    result: ConsumePlayerPurchase(input: $input) {
        ...PurchaseOutput
    }
}