(self.webpackChunkgame_score_sdk=self.webpackChunkgame_score_sdk||[]).push([[9070],{4340:(t,e,r)=>{"use strict";r.d(e,{D:()=>i});const i=()=>Promise.resolve({success:!1,rating:0,error:""})},9:(t,e,r)=>{"use strict";r.d(e,{Z:()=>n});var i=r(4340),s=function(t,e,r,i){return new(r||(r=Promise))((function(s,n){function a(t){try{u(i.next(t))}catch(t){n(t)}}function o(t){try{u(i.throw(t))}catch(t){n(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))};class n{constructor(){this.canAddShortcut=!1,this.canRequestReview=!1,this.isAlreadyReviewed=!1}addShortcut(){return s(this,void 0,void 0,(function*(){return!1}))}requestReview(){return(0,i.D)()}requestGameUrl(){return s(this,void 0,void 0,(function*(){}))}}},5572:(t,e,r)=>{"use strict";r.d(e,{VK:()=>i,yl:()=>s});const i={success:!0,payload:{}},s={success:!1,payload:{}}},2712:(t,e,r)=>{"use strict";r.d(e,{aD:()=>l,FU:()=>p,hc:()=>v});const i=(t,e)=>({type:t,getLink:e}),s=i("facebook",(t=>`//www.facebook.com/sharer/sharer.php?u=${t.url}`)),n=i("whatsapp",(t=>`//api.whatsapp.com/send?text=${t.text}%20${t.url}`)),a=i("telegram",(t=>`//t.me/share/url?url=${t.url}&text=${t.text}`)),o=i("vkontakte",(t=>`//vk.com/share.php?url=${t.url}&title=${t.text}&image=${t.image}`)),u=i("twitter",(t=>`//twitter.com/share?text=${t.text}&url=${t.url}`)),d=i("odnoklassniki",(t=>`//connect.ok.ru/offer?url=${t.url}&title=${t.text}&imageUrl=${t.image}`)),h=i("viber",(t=>`viber://forward?text=${t.text}%20${t.url}`)),c=i("moymir",(t=>`//connect.mail.ru/share?url=${t.url}&title=${t.text}&image_url=${t.image}`)),l=[n,a,o,d,h,c],p=[s,u,a,n,h],v=[s,u,a,n,h,o,d,c]},5092:(t,e,r)=>{"use strict";r.d(e,{M:()=>i});const i=(t,e,r,i)=>{var s;const n=(window.innerWidth-r)/2,a=(window.innerHeight-i)/2,o=window.open(t,e,`scrollbars=yes,\n        width=${r},\n        height=${i},\n        top=${a},\n        left=${n}\n        `);return null===(s=o.focus)||void 0===s||s.call(o),o}},209:(t,e,r)=>{"use strict";r.d(e,{Z:()=>s});var i=r(6558);const s={stringify:t=>btoa(encodeURIComponent(JSON.stringify(t))),parse(t){if(!t)return{};const e=function(t){try{return JSON.parse(decodeURIComponent(atob(t)||"{}"))}catch(t){return""}}(t);return Object.keys(e).length>0?e:JSON.parse(function(t){try{return JSON.parse(atob(t)||"{}")}catch(t){return""}}(t)||"{}")},addShareParamsToUrl(t,e){try{const r=new URL(t);return Object.entries(e).forEach((([t,e])=>{r.searchParams.set(t,e)})),r.href}catch(e){i.kg.error("Invalid URL",t,e)}return t}}},558:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>I});var i=r(8293),s=function(t,e,r,i){return new(r||(r=Promise))((function(s,n){function a(t){try{u(i.next(t))}catch(t){n(t)}}function o(t){try{u(i.throw(t))}catch(t){n(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))};class n{constructor(t,e){this.gp=t,this.sdk=e,this.hasCredetials=!1,this.isAuthorizedAtPlatform=!0}get userId(){return String(this.sdk.userId)}get authKey(){return String(this.sdk.authKey)}get appId(){return String(this.sdk.appId)}getPlayerAuthInfo(){return s(this,void 0,void 0,(function*(){const t=(0,i._)();yield this.sdk.ready;const{searchParams:e}=new URL(window.location.href),r={},s=[];this.sdk.vkAuthUrl&&(this.gp.player.once("sync:before",(()=>{this.gp.player._platformData={}})),e.set("vkAuthUrl",this.sdk.vkAuthUrl),e.set("appid",this.appId),e.set("uid",this.userId),e.set("sign",this.authKey)),e.forEach(((t,e)=>{s.push(e),r[e]=t})),r._gpOrderedKeys=s;const n=yield this.sdk.getLoginStatus();return this.hasCredetials=n>1,t.done(r),t.ready}))}getPlayerContext(){return s(this,void 0,void 0,(function*(){const t=yield this.getPlayerAuthInfo();return{platformData:t,key:t.uid}}))}loginPlayer(){return s(this,void 0,void 0,(function*(){return yield this.sdk.ready,yield this.sdk.login(),this.sdk.getPlayer()}))}logoutPlayer(){return s(this,void 0,void 0,(function*(){return!1}))}getPlayer(){return s(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.getPlayer()}))}publishRecord(t){}isPlatformAvatar(t){return t.includes("avatar.my.games")||t.startsWith("https://avatar.vkplay.ru")}setCredentials(t){}}var a=r(2712),o=r(5942),u=r(5572),d=function(t,e,r,i){return new(r||(r=Promise))((function(s,n){function a(t){try{u(i.next(t))}catch(t){n(t)}}function o(t){try{u(i.throw(t))}catch(t){n(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))};class h{constructor(t){this.sdk=t,this.hasIntegratedAuth=!0,this.isExternalLinksAllowed=!0,this.isSecretCodeAuthAvailable=!1,this._hasAuthModal=!0,this.isLogoutAvailable=!1,this.type=o.z.VK_PLAY,this.socialNetworks=a.aD,this.isSupportsImageUploading=!1,this.hasAccountLinkingFeature=!1,this.isSupportsRemoteVariables=!1,this.isSupportsCloudSaves=!1}getSDK(){return this.sdk}getNativeSDK(){return this.sdk.sdk}requestPermissions(){return d(this,void 0,void 0,(function*(){return u.VK}))}uploadImage(){return null}getVariables(){return d(this,void 0,void 0,(function*(){return{}}))}}var c,l=r(4917),p=r(6558),v=r(9503),f=r(5092),y=r(8866),g=r(209),m=function(t,e,r,i){return new(r||(r=Promise))((function(s,n){function a(t){try{u(i.next(t))}catch(t){n(t)}}function o(t){try{u(i.throw(t))}catch(t){n(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))};!function(t){t[t.GUEST=0]="GUEST",t[t.NOT_REGISTERED=1]="NOT_REGISTERED",t[t.REGISTERED=2]="REGISTERED",t[t.REGISTERED_AND_HAS_PURCHASE=3]="REGISTERED_AND_HAS_PURCHASE"}(c||(c={}));class k{constructor(t,e){this.config=t,this.gp=e,this.needToLeaveFullscreenBeforeAds=!1;const{searchParams:r}=new URL(window.location.href);this.userId=r.get("uid"),this.authKey=r.get("sign"),this.appId=r.get("appid");const i=(r.get("lang")||"").split("_")[0];this.lang=Object.values(v.Uo).includes(i)?i:null,this.needToLeaveFullscreenBeforeAds=!e.isMobile;try{const t=new URL(window.location.href).searchParams.get("_gpParams");t&&(this.shareParams=g.Z.parse(t))}catch(t){p.kg.error(t)}}get appUrl(){return`https://vkplay.ru/app/${this.appId}`}init(t){return m(this,void 0,void 0,(function*(){!this.appId&&t&&(this.appId=t);const e=[(0,l.Z)({src:`//vkplay.ru/app/${this.appId}/static/mailru.core.js`,check:t=>"iframeApi"in t}).catch(p.kg.error)],r=(0,i._)({timeout:1e4});return Promise.all(e).then((()=>m(this,void 0,void 0,(function*(){const t=window.iframeApi;void 0!==t?t({appid:this.appId,getLoginStatusCallback:t=>{this.getLoginTransaction.done(t)},userInfoCallback:t=>{this.userInfoTransaction.done(t)},userProfileCallback:t=>{this.userProfileTransaction.done(t)},registerUserCallback:t=>{this.registerUserTransaction.done(t)},paymentFrameUrlCallback:t=>{},getAuthTokenCallback:t=>{this.getAuthTokenTransaction.done(t)},paymentReceivedCallback:t=>{this.paymentReceivedTransaction.done(t)},paymentWindowClosedCallback:()=>{},userConfirmCallback:()=>{},adsCallback:t=>{this.showAdsTransaction.done(t)}}).then((t=>m(this,void 0,void 0,(function*(){this.sdk=t;try{(yield this.getLoginStatus())===c.NOT_REGISTERED&&(yield this.registerUser())&&(yield this.refreshUserInfo())}catch(t){p.kg.error(t)}r.done(this)}))),r.abort):r.abort("Cannot find iframeApi function, are we inside an iframe?")})))),this.ready=r.ready,this.ready}))}refreshUserInfo(){return m(this,void 0,void 0,(function*(){this.getAuthTokenTransaction=(0,i._)(),this.sdk.getAuthToken();const{uid:t,hash:e,url:r}=yield this.getAuthTokenTransaction.ready;this.vkAuthUrl=r,this.userId=t,this.authKey=e}))}getLoginStatus(){return m(this,void 0,void 0,(function*(){return this.getLoginTransaction=(0,i._)(),this.sdk.getLoginStatus(),(yield this.getLoginTransaction.ready).loginStatus||0}))}registerUser(){return m(this,void 0,void 0,(function*(){return this.registerUserTransaction=(0,i._)(),this.sdk.registerUser(),"ok"===(yield this.registerUserTransaction.ready).status}))}login(){return m(this,void 0,void 0,(function*(){yield this.sdk.authUser()}))}getPlayer(){return m(this,void 0,void 0,(function*(){this.userProfileTransaction=(0,i._)(i.s),yield this.ready,this.sdk.userProfile();const t=yield this.userProfileTransaction.ready,{uid:e,nick:r,avatar:s}=t||{};return{id:e||"",name:r||"",photoSmall:s||"",photoMedium:s||"",photoLarge:s||"",signature:this.authKey}}))}showRewardedVideo(){return m(this,void 0,void 0,(function*(){return this.showAdsTransaction=(0,i._)(),yield this.ready,this.sdk.showAds({interstitial:!1}),this.showAdsTransaction.ready.then((t=>"adCompleted"===(null==t?void 0:t.type)))}))}showPreloader(){return m(this,void 0,void 0,(function*(){return this.showAdsTransaction=(0,i._)(),yield this.ready,this.sdk.showAds({interstitial:!0}),this.showAdsTransaction.ready.then((t=>"adError"!==(null==t?void 0:t.type)))}))}showFullscreen(){return m(this,void 0,void 0,(function*(){return this.showAdsTransaction=(0,i._)(),yield this.ready,this.sdk.showAds({interstitial:!0}),this.showAdsTransaction.ready.then((t=>"adError"!==(null==t?void 0:t.type)))}))}purchase(t){var e;return m(this,void 0,void 0,(function*(){if(this.paymentReceivedTransaction=(0,i._)(),!this.gp.player.isLoggedInByPlatform)try{yield this.gp.player.login()}catch(t){return}this.sdk.isRegisteredInCurrentSession&&(yield this.sdk.reloadWindow());try{const e=yield this.gp._services.paymentsService.getPaymentLink({productId:t.id});if(e){const t=(0,f.M)(e.link,"",830,622),r=setInterval((()=>m(this,void 0,void 0,(function*(){t.closed&&(clearInterval(r),yield(0,y.Z)(4e3),this.paymentReceivedTransaction.abort("purchase_window_closed"))}))),1e3)}}catch(t){"not_authorized"===t&&this.gp.player.isLoggedInByPlatform&&(yield this.sdk.reloadWindow()),this.paymentReceivedTransaction.abort((null===(e=null==t?void 0:t.error_data)||void 0===e?void 0:e.error_reason)||t)}return this.paymentReceivedTransaction.ready}))}addShareParamsToUrl(t,e){return g.Z.addShareParamsToUrl(t,{_gpParams:g.Z.stringify(e)})}makeShareUrl(t){return this.addShareParamsToUrl(this.gp.app.url,t)}getShareParam(t){return this.shareParams?this.shareParams[t]:""}}var w=function(t,e,r,i){return new(r||(r=Promise))((function(s,n){function a(t){try{u(i.next(t))}catch(t){n(t)}}function o(t){try{u(i.throw(t))}catch(t){n(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))};class S{constructor(t){this.sdk=t,this.isRewardedAvailable=!0,this.isPreloaderAvailable=!0,this.isFullscreenAvailable=!0,this.isStickyAvailable=!1,this.stickyBannerConfig={isOverlapping:!1,height:0},this.canShowFullscreenBeforeGamePlay=!0}get needToLeaveFullscreenBeforeAds(){return this.sdk.needToLeaveFullscreenBeforeAds}showPreloader(){return w(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.showPreloader().catch((()=>!1))}))}showFullscreen(){return w(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.showFullscreen().catch((()=>!1))}))}showRewardedVideo(){return w(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.showRewardedVideo().catch((()=>!1))}))}showSticky(t){return w(this,void 0,void 0,(function*(){return!1}))}refreshSticky(t){return w(this,void 0,void 0,(function*(){return!1}))}closeSticky(){return w(this,void 0,void 0,(function*(){}))}}var P=r(9);class A{constructor(t){this.sdk=t,this.isSupportsShare=!0,this.isSupportsNativeShare=!1,this.isSupportsNativePosts=!1,this.isSupportsNativeInvite=!1,this.isSupportsNativeCommunityJoin=!1,this.canJoinCommunity=!1,this.isSupportShareParams=!0}get shareParams(){return this.sdk.shareParams}share(t){return Promise.resolve(!1)}post(t){return Promise.resolve(!1)}invite(t){return Promise.resolve(!1)}joinCommunity(){return Promise.resolve(!1)}getCommunityLink(t){return t}addShareParamsToUrl(t,e){return this.sdk.addShareParamsToUrl(t,e)}makeShareUrl(t){return this.sdk.makeShareUrl(t)}getShareParam(t){return this.sdk.getShareParam(t)}}var T=function(t,e,r,i){return new(r||(r=Promise))((function(s,n){function a(t){try{u(i.next(t))}catch(t){n(t)}}function o(t){try{u(i.throw(t))}catch(t){n(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))};const b={[v.Uo.RU]:"Руб",[v.Uo.EN]:"Rub"};class U{constructor(t){this.sdk=t,this.isSupportsSubscriptions=!0,this.isOneTimeSubscription=!1,this.isSupportsPayments=!0,this.isServerValidation=!0,this.isNeedAuthorizeBeforePurchase=!0}mapProducts(t,e){return T(this,void 0,void 0,(function*(){return e.map((e=>Object.assign(Object.assign({},e),{currencySymbol:b[t.language]||b[v.Uo.EN],currency:"RUB"})))}))}consumeAllExpired(t,e,r){return T(this,void 0,void 0,(function*(){}))}fetchPurchases(){return T(this,void 0,void 0,(function*(){return{payload:{},purchases:[]}}))}purchase(t){return T(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.purchase(t)}))}consume(t){return T(this,void 0,void 0,(function*(){return{}}))}subscribe(t){return T(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.purchase(t)}))}unsubscribe(t,e){return T(this,void 0,void 0,(function*(){return{}}))}}function I(t){return e=this,r=void 0,s=function*(){const e=new k({},t.gp),r=[];r.push(t.setupStorage([]),t.fetchConfig(e.lang)),e.appId&&r.push(e.init());const i=(yield Promise.all(r))[1];e.appId||(yield e.init(i.platformConfig.appId).catch(p.kg.error));const s=new n(t.gp,e);return{adsAdapter:new S(e),appAdapter:new P.Z,playerAdapter:s,platformAdapter:new h(e),socialsAdapter:new A(e),paymentsAdapter:new U(e),projectConfig:i}},new((i=void 0)||(i=Promise))((function(t,n){function a(t){try{u(s.next(t))}catch(t){n(t)}}function o(t){try{u(s.throw(t))}catch(t){n(t)}}function u(e){var r;e.done?t(e.value):(r=e.value,r instanceof i?r:new i((function(t){t(r)}))).then(a,o)}u((s=s.apply(e,r||[])).next())}));var e,r,i,s}}}]);