(self.webpackChunkgame_score_sdk=self.webpackChunkgame_score_sdk||[]).push([[4341],{4340:(t,e,r)=>{"use strict";r.d(e,{D:()=>i});const i=()=>Promise.resolve({success:!1,rating:0,error:""})},5572:(t,e,r)=>{"use strict";r.d(e,{VK:()=>i,yl:()=>n});const i={success:!0,payload:{}},n={success:!1,payload:{}}},2712:(t,e,r)=>{"use strict";r.d(e,{aD:()=>l,FU:()=>p,hc:()=>f});const i=(t,e)=>({type:t,getLink:e}),n=i("facebook",(t=>`//www.facebook.com/sharer/sharer.php?u=${t.url}`)),s=i("whatsapp",(t=>`//api.whatsapp.com/send?text=${t.text}%20${t.url}`)),o=i("telegram",(t=>`//t.me/share/url?url=${t.url}&text=${t.text}`)),a=i("vkontakte",(t=>`//vk.com/share.php?url=${t.url}&title=${t.text}&image=${t.image}`)),u=i("twitter",(t=>`//twitter.com/share?text=${t.text}&url=${t.url}`)),c=i("odnoklassniki",(t=>`//connect.ok.ru/offer?url=${t.url}&title=${t.text}&imageUrl=${t.image}`)),h=i("viber",(t=>`viber://forward?text=${t.text}%20${t.url}`)),d=i("moymir",(t=>`//connect.mail.ru/share?url=${t.url}&title=${t.text}&image_url=${t.image}`)),l=[s,o,a,c,h,d],p=[n,u,o,s,h],f=[n,u,o,s,h,a,c,d]},209:(t,e,r)=>{"use strict";r.d(e,{Z:()=>n});var i=r(6558);const n={stringify:t=>btoa(encodeURIComponent(JSON.stringify(t))),parse(t){if(!t)return{};const e=function(t){try{return JSON.parse(decodeURIComponent(atob(t)||"{}"))}catch(t){return""}}(t);return Object.keys(e).length>0?e:JSON.parse(function(t){try{return JSON.parse(atob(t)||"{}")}catch(t){return""}}(t)||"{}")},addShareParamsToUrl(t,e){try{const r=new URL(t);return Object.entries(e).forEach((([t,e])=>{r.searchParams.set(t,e)})),r.href}catch(e){i.kg.error("Invalid URL",t,e)}return t}}},9991:(t,e,r)=>{"use strict";function i(t,e=0){return new Promise(((r,i)=>{let n=0;t(window)?r():(n=setInterval((function(){t(window)&&(clearInterval(n),r())}),100),e>0&&setTimeout((()=>{clearInterval(n),i(new Error("Timeout reached"))}),e))}))}r.d(e,{Z:()=>i})},7751:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>C});var i=r(4917),n=r(6558),s=r(8293),o=r(209),a=r(9991),u=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))};class c{constructor(t,e){this.gp=t,this.config=e;const r=new URL(window.location.href).searchParams;this.userId=parseInt(r.get("viewerId")||"0",10),this.authKey=r.get("authKey")||"",this.appId=r.get("apiId")||"",this.apiUrl=r.get("apiUrl")||""}get appUrl(){return`https://fotostrana.ru/app/${this.appId}`}init(){return u(this,void 0,void 0,(function*(){const t=(0,s._)();this.ready=t.ready;try{yield(0,i.Z)({src:new URL(window.location.href).searchParams.get("fsapi")||"",check:t=>"fsapi"in t}),this.fsapi=new window.fsapi(this.appId,this.config.publicKey),this.fsapi.init((()=>n.kg.error("API Initialization Error"))),t.done(this)}catch(e){n.kg.error("Failed to initialize FSSDK",e),t.abort(e)}return t.ready}))}getPlayer(){return u(this,void 0,void 0,(function*(){const t=(0,s._)();return yield this.ready,this.fsapi.api("User.getProfiles",{userIds:this.userId,fields:["user_name","user_lastname","photo_small","photo_192","photo_big"].join(",")},(e=>{if(e.error)return void t.abort(e.error);const{user_name:r,user_lastname:i,photo_small:n,photo_192:s,photo_big:o}=e.response[this.userId];t.done({id:this.userId,name:[r,i].filter(Boolean).join(" "),photoSmall:n||"",photoMedium:s||"",photoLarge:o||"",signature:this.authKey})})),t.ready}))}purchase(t){return u(this,void 0,void 0,(function*(){const e=(0,s._)();yield this.ready;const r={itemId:t.id,name:t.name,priceFmCents:100*t.price,picUrl:t.icon,forwardData:JSON.stringify({appId:this.appId}),amount:1,isDebug:1},i=yield this.callEvent("buyItemCallback",r);return"success"===i.result?e.done({orderId:i.transactionId}):"cancel"===i.result?e.abort("User cancelled the purchase"):e.abort("Purchase error"),e.ready}))}invite(){return u(this,void 0,void 0,(function*(){return this.callEvent("invite").then((t=>t.send>0)).catch((()=>!1))}))}joinCommunity(){return u(this,void 0,void 0,(function*(){return this.callEvent("subscribePublic").then((t=>1===t.result)).catch((()=>!1))}))}post(t){return u(this,void 0,void 0,(function*(){const e={text:t.text||"",imgUrl:t.image||"",title:this.config.appName||""};let r=null;const i=(0,s._)();this.fsapi.event("postUserEventOnWall",(t=>{if(t.error)return r=!1,void i.abort(`failed to request postUserEventOnWall, reason: ${t.error}`);"close"!==t.result?"success"===t.result?r=!0:"refuse"===t.result&&(r=!1):i.done()}),e);try{yield i.ready}catch(t){return!1}return yield(0,a.Z)((()=>null!==r),2e3),r}))}canAddShortcut(){return u(this,void 0,void 0,(function*(){const t=yield this.callEvent("isAppInFav").then((t=>!!t.isAppInFav)).catch((()=>!1)),e=this.callEvent("isAddAppToFavAllowed").then((t=>!!t.canFav)).catch((()=>!1));return!t&&e}))}addShortcut(){return this.callEvent("addAppToFav").then((t=>!!t.status)).catch((()=>!1))}addShareParamsToUrl(t,e){return o.Z.addShareParamsToUrl(t,{_gpParams:o.Z.stringify(e)})}makeShareUrl(t){return this.addShareParamsToUrl(this.gp.app.url,t)}getShareParam(t){return this.shareParams?this.shareParams[t]:""}callEvent(t,e={}){return u(this,void 0,void 0,(function*(){yield this.ready;const r=(0,s._)();try{this.fsapi.event(t,(e=>{e.error?r.abort(`failed to request ${t}, reason: ${e.error}`):r.done(e)}),e)}catch(t){r.abort(t)}return r.ready}))}}var h=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))};class d{constructor(t){this.sdk=t,this.isFullscreenAvailable=!1,this.stickyBannerConfig={isOverlapping:!1,height:0},this.isRewardedAvailable=!1,this.isPreloaderAvailable=!1,this.isStickyAvailable=!1,this.needToLeaveFullscreenBeforeAds=!1,this.canShowFullscreenBeforeGamePlay=!1}showPreloader(){return h(this,void 0,void 0,(function*(){return!1}))}showFullscreen(){return h(this,void 0,void 0,(function*(){return!1}))}showRewardedVideo(){return h(this,void 0,void 0,(function*(){return!1}))}showSticky(){return h(this,void 0,void 0,(function*(){return!1}))}refreshSticky(){return h(this,void 0,void 0,(function*(){return!1}))}closeSticky(){return h(this,void 0,void 0,(function*(){}))}}var l=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))};class p{constructor(t){this.sdk=t,this.hasCredetials=!1,this.userId="",this.isAuthorizedAtPlatform=!1}getPlayerAuthInfo(){return l(this,void 0,void 0,(function*(){const t=(0,s._)();return yield this.sdk.ready,this.hasCredetials=String(this.sdk.userId).length>0,t.done({authKey:this.sdk.authKey,userId:this.sdk.userId,appId:this.sdk.appId}),t.ready}))}getPlayerContext(){return l(this,void 0,void 0,(function*(){return{platformData:yield this.getPlayerAuthInfo(),key:""}}))}loginPlayer(){return l(this,void 0,void 0,(function*(){return this.sdk.getPlayer()}))}logoutPlayer(){return l(this,void 0,void 0,(function*(){return!1}))}getPlayer(){return l(this,void 0,void 0,(function*(){return this.sdk.getPlayer()}))}publishRecord(t){}isPlatformAvatar(){return!1}setCredentials(t){}}var f=r(2712),v=r(5942),y=r(5572),m=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))};class g{constructor(t){this.sdk=t,this.hasIntegratedAuth=!0,this.isExternalLinksAllowed=!1,this.isSecretCodeAuthAvailable=!1,this._hasAuthModal=!1,this.isLogoutAvailable=!1,this.type=v.z.FOTOSTRANA,this.socialNetworks=f.aD,this.isSupportsImageUploading=!1,this.hasAccountLinkingFeature=!1,this.isSupportsRemoteVariables=!1,this.isSupportsCloudSaves=!1}getSDK(){return this.sdk}getNativeSDK(){return this.sdk.fsapi}requestPermissions(){return m(this,void 0,void 0,(function*(){return y.VK}))}uploadImage(){return null}getVariables(){return m(this,void 0,void 0,(function*(){return{}}))}}var w=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))};class k{constructor(t,e){this.sdk=t,this.gp=e,this.isSupportsNativeShare=!1,this.isSupportsNativePosts=!0,this.isSupportsNativeInvite=!0,this.isSupportsNativeCommunityJoin=!0,this.canJoinCommunity=!0}get isSupportsShare(){return!!this.gp.platform.config.gameLink}get isSupportShareParams(){return!!this.gp.platform.config.gameLink}get shareParams(){return this.sdk.shareParams}share(t){return Promise.resolve(!1)}post(t){return w(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.post(t)}))}invite(){return w(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.invite()}))}joinCommunity(){return this.sdk.joinCommunity()}getCommunityLink(t){return t}addShareParamsToUrl(t,e){return this.sdk.addShareParamsToUrl(t,e)}makeShareUrl(t){return this.sdk.makeShareUrl(t)}getShareParam(t){return this.sdk.getShareParam(t)}}var S=r(9503),P=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))};const b={[S.Uo.RU]:"ФМ",[S.Uo.EN]:"FM"};class I{constructor(t){this.sdk=t,this.isSupportsSubscriptions=!1,this.isSupportsPayments=!0,this.isServerValidation=!0,this.isOneTimeSubscription=!0,this.isNeedAuthorizeBeforePurchase=!1}mapProducts(t,e){return P(this,void 0,void 0,(function*(){return e.map((e=>Object.assign(Object.assign({},e),{currencySymbol:b[t.language]||b[S.Uo.EN],currency:"FM"})))}))}consumeAllExpired(t,e,r){return P(this,void 0,void 0,(function*(){}))}fetchPurchases(){return P(this,void 0,void 0,(function*(){return{payload:{},purchases:[]}}))}purchase(t){return P(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.purchase(t)}))}consume(t){return P(this,void 0,void 0,(function*(){return{}}))}subscribe(t,e){return P(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.purchase(t)}))}unsubscribe(t,e){return P(this,void 0,void 0,(function*(){return{}}))}}var A=r(4340),x=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))};class U{constructor(t){this.sdk=t,this.canAddShortcut=!1,this.canRequestReview=!1,this.isAlreadyReviewed=!1,this.sdk.canAddShortcut().then((t=>{this.canAddShortcut=t}))}addShortcut(){return x(this,void 0,void 0,(function*(){const t=yield this.sdk.addShortcut();return t&&(this.canAddShortcut=!1),t}))}requestReview(){return(0,A.D)()}requestGameUrl(){return x(this,void 0,void 0,(function*(){}))}}function C(t){return e=this,r=void 0,n=function*(){const[,e]=yield Promise.all([t.setupStorage([]),t.fetchConfig()]),r=new c(t.gp,{appName:e.project.name,appId:e.platformConfig.appId,publicKey:e.platformConfig.publicKey});yield r.init();const i=new p(r),n=new d(r);return{appAdapter:new U(r),adsAdapter:n,playerAdapter:i,platformAdapter:new g(r),socialsAdapter:new k(r,t.gp),paymentsAdapter:new I(r),projectConfig:e}},new((i=void 0)||(i=Promise))((function(t,s){function o(t){try{u(n.next(t))}catch(t){s(t)}}function a(t){try{u(n.throw(t))}catch(t){s(t)}}function u(e){var r;e.done?t(e.value):(r=e.value,r instanceof i?r:new i((function(t){t(r)}))).then(o,a)}u((n=n.apply(e,r||[])).next())}));var e,r,i,n}}}]);