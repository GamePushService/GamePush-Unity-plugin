(self.webpackChunkgame_score_sdk=self.webpackChunkgame_score_sdk||[]).push([[8662],{4340:(t,e,i)=>{"use strict";i.d(e,{D:()=>r});const r=()=>Promise.resolve({success:!1,rating:0,error:""})},9:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var r=i(4340),n=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{d(r.next(t))}catch(t){s(t)}}function o(t){try{d(r.throw(t))}catch(t){s(t)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}d((r=r.apply(t,e||[])).next())}))};class s{constructor(){this.canAddShortcut=!1,this.canRequestReview=!1,this.isAlreadyReviewed=!1}addShortcut(){return n(this,void 0,void 0,(function*(){return!1}))}requestReview(){return(0,r.D)()}requestGameUrl(){return n(this,void 0,void 0,(function*(){}))}}},5572:(t,e,i)=>{"use strict";i.d(e,{VK:()=>r,yl:()=>n});const r={success:!0,payload:{}},n={success:!1,payload:{}}},2712:(t,e,i)=>{"use strict";i.d(e,{aD:()=>l,FU:()=>v,hc:()=>f});const r=(t,e)=>({type:t,getLink:e}),n=r("facebook",(t=>`//www.facebook.com/sharer/sharer.php?u=${t.url}`)),s=r("whatsapp",(t=>`//api.whatsapp.com/send?text=${t.text}%20${t.url}`)),a=r("telegram",(t=>`//t.me/share/url?url=${t.url}&text=${t.text}`)),o=r("vkontakte",(t=>`//vk.com/share.php?url=${t.url}&title=${t.text}&image=${t.image}`)),d=r("twitter",(t=>`//twitter.com/share?text=${t.text}&url=${t.url}`)),u=r("odnoklassniki",(t=>`//connect.ok.ru/offer?url=${t.url}&title=${t.text}&imageUrl=${t.image}`)),c=r("viber",(t=>`viber://forward?text=${t.text}%20${t.url}`)),h=r("moymir",(t=>`//connect.mail.ru/share?url=${t.url}&title=${t.text}&image_url=${t.image}`)),l=[s,a,o,u,c,h],v=[n,d,a,s,c],f=[n,d,a,s,c,o,u,h]},209:(t,e,i)=>{"use strict";i.d(e,{Z:()=>n});var r=i(6558);const n={stringify:t=>btoa(encodeURIComponent(JSON.stringify(t))),parse(t){if(!t)return{};const e=function(t){try{return JSON.parse(decodeURIComponent(atob(t)||"{}"))}catch(t){return""}}(t);return Object.keys(e).length>0?e:JSON.parse(function(t){try{return JSON.parse(atob(t)||"{}")}catch(t){return""}}(t)||"{}")},addShareParamsToUrl(t,e){try{const i=new URL(t);return Object.entries(e).forEach((([t,e])=>{i.searchParams.set(t,e)})),i.href}catch(e){r.kg.error("Invalid URL",t,e)}return t}}},1423:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>U});var r=i(4917),n=i(6558),s=i(8293),a=i(209),o=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{d(r.next(t))}catch(t){s(t)}}function o(t){try{d(r.throw(t))}catch(t){s(t)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}d((r=r.apply(t,e||[])).next())}))};class d{constructor(t,e){var i;this.gp=t,this.config=e,this.userId="",this._hasCredetials=!1,this.isLoggedIn=!1,this.hideDialogCallback=null,this.channelId=(null===(i=e.platformConfig.payload)||void 0===i?void 0:i.adsenseID)||"";const r=new URL(window.location.href).searchParams.get("_gpParams");r&&(this.shareParams=a.Z.parse(r))}get appUrl(){return this.config.platformConfig.gameLink}init(){return o(this,void 0,void 0,(function*(){const t=(0,s._)();this.idAsyncInitTransaction=(0,s._)(),this.ready=t.ready,window.idAsyncInit=()=>o(this,void 0,void 0,(function*(){this.y8Sdk=window.ID,this.y8Sdk.Event.subscribe("id.init",(()=>o(this,void 0,void 0,(function*(){const t=yield this.getLoginStatus();(null==t?void 0:t.authResponse)&&this.refreshUserInfo(t),this.idAsyncInitTransaction.done(),this.gp.ready.then((()=>{this.gp.achievements.on("unlock",(t=>{this.y8Sdk.GameAPI.Achievements.save({achievement:t.names.en,achievementkey:t.y8Id||JSON.stringify("")})}))}))})))),this.y8Sdk.init({appId:this.config.platformConfig.appId})}));try{yield(0,r.Z)({src:"https://cdn.y8.com/api/sdk.js",check:t=>"ID"in t}),this.adBreakInitialization(),t.done(this)}catch(e){n.kg.error("Failed to initialize Y8 SDK: ",e),t.abort(e)}return t.ready}))}getLoginStatus(){return o(this,void 0,void 0,(function*(){const t=(0,s._)();return this.y8Sdk.getLoginStatus((e=>{t.done(e)})),t.ready}))}login(){return o(this,void 0,void 0,(function*(){const t=(0,s._)();return this.hideDialogCallback=this.createHideDialogCallback(),this.y8Sdk.Event.subscribe("dialog.hide",this.hideDialogCallback),this.y8Sdk.login((e=>{this.y8Sdk.Event.unsubscribe("dialog.hide",this.hideDialogCallback);const i=this.userInfoToPlayerState(e);t.done(i)})),t.ready}))}getPlayer(){return o(this,void 0,void 0,(function*(){const t=(0,s._)();yield this.ready;const e=yield this.getLoginStatus(),i=this.userInfoToPlayerState(e);return t.done(i),t.ready}))}createHideDialogCallback(){return()=>{this.isLoggedIn||this.gp.player._events.emit("login",!1),this.y8Sdk.Event.unsubscribe("dialog.hide",this.hideDialogCallback)}}refreshUserInfo(t){this.userId=t.authResponse.details.pid,this._hasCredetials=!0,this.isLoggedIn=!0}userInfoToPlayerState(t){var e,i,r;if(!t)return{id:0,name:"",photoSmall:"",photoMedium:"",photoLarge:""};const n=t.authResponse.details||{},s=n.last_name?`${n.first_name} ${n.last_name}`:n.nickname;return this.refreshUserInfo(t),{id:n.pid||0,name:s||"",photoSmall:(null===(e=n.avatars)||void 0===e?void 0:e.thumb_secure_url)||"",photoMedium:(null===(i=n.avatars)||void 0===i?void 0:i.medium_secure_url)||"",photoLarge:(null===(r=n.avatars)||void 0===r?void 0:r.large_secure_url)||""}}showFullscreen(){return o(this,void 0,void 0,(function*(){const t=(0,s._)();let e=!1;return this.adBreak({type:"start",name:"interstitial",adBreakDone:t=>{e="viewed"===(null==t?void 0:t.breakStatus)}}),t.done(e),t.ready}))}showRewardedVideo(){return o(this,void 0,void 0,(function*(){const t=(0,s._)();return this.adBreak({type:"reward",name:"rewarded",beforeReward:t=>{t(0)},adDismissed:()=>!1,adViewed:()=>!1,adBreakDone:e=>{t.done("viewed"===(null==e?void 0:e.breakStatus))}}),t.ready}))}encodeFileToBase64(t){return o(this,void 0,void 0,(function*(){const e=(0,s._)(),i=new FileReader;return i.onload=t=>{var i;const r=null===(i=t.target)||void 0===i?void 0:i.result,n=new Image;n.onload=()=>{e.done({width:n.width,height:n.height,src:r})},n.onerror=t=>{e.abort(`Failed to load image: ${t}`)},n.src=r},i.onerror=()=>{e.abort("Failed to read file")},i.readAsDataURL(t),e.ready}))}uploadImage(t){return o(this,void 0,void 0,(function*(){const e=(0,s._)();try{const i=yield this.encodeFileToBase64(t);this.y8Sdk.submit_image(i.src,(t=>{e.done(t.success?{width:i.width,height:i.height,src:t.image}:{width:0,height:0,src:""})}))}catch(t){e.abort(`Upload failed: ${t}`)}return e.ready}))}addShareParamsToUrl(t,e){return a.Z.addShareParamsToUrl(t,{_gpParams:a.Z.stringify(e)})}makeShareUrl(t){return this.addShareParamsToUrl(this.gp.app.url,t)}getShareParam(t){return this.shareParams?this.shareParams[t]:""}adBreakInitialization(){window.adsbygoogle=window.adsbygoogle||[],this.adBreak=t=>window.adsbygoogle.push(t),this.adBreak({preloadAdBreaks:"on",sound:"on",onReady:()=>!1});const t=this.channelId,e=document.createElement("script");e.setAttribute("data-ad-client","ca-pub-6129580795478709"),e.setAttribute("data-ad-channel",t),e.setAttribute("data-ad-frequency-hint","180s"),e.async=!0,e.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js";const i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(e,i)}}var u=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{d(r.next(t))}catch(t){s(t)}}function o(t){try{d(r.throw(t))}catch(t){s(t)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}d((r=r.apply(t,e||[])).next())}))};class c{constructor(t){this.sdk=t,this.isAuthorizedAtPlatform=!0}get hasCredetials(){return this.sdk._hasCredetials}get userId(){return this.sdk.userId}getPlayerAuthInfo(){return u(this,void 0,void 0,(function*(){const t=(0,s._)();return yield this.sdk.ready,yield this.sdk.idAsyncInitTransaction.ready,t.done({id:this.userId}),t.ready}))}getPlayerContext(){return u(this,void 0,void 0,(function*(){const{id:t}=yield this.getPlayerAuthInfo();return{platformData:{id:t},key:t}}))}loginPlayer(){return u(this,void 0,void 0,(function*(){return this.sdk.login()}))}logoutPlayer(){return u(this,void 0,void 0,(function*(){return!1}))}getPlayer(){return u(this,void 0,void 0,(function*(){return this.sdk.getPlayer()}))}publishRecord(t){}isPlatformAvatar(){return!1}setCredentials(t){}}var h=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{d(r.next(t))}catch(t){s(t)}}function o(t){try{d(r.throw(t))}catch(t){s(t)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}d((r=r.apply(t,e||[])).next())}))};class l{constructor(t){this.sdk=t,this.isFullscreenAvailable=!0,this.stickyBannerConfig={isOverlapping:!1,height:0},this.isRewardedAvailable=!0,this.isPreloaderAvailable=!0,this.isStickyAvailable=!1,this.needToLeaveFullscreenBeforeAds=!1,this.canShowFullscreenBeforeGamePlay=!1}showFullscreen(){return h(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.showFullscreen().catch((()=>!1))}))}showPreloader(){return h(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.showFullscreen().catch((()=>!1))}))}showRewardedVideo(){return h(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.showRewardedVideo().catch((()=>!1))}))}showSticky(t){return h(this,void 0,void 0,(function*(){return yield this.sdk.ready,!1}))}refreshSticky(t){return h(this,void 0,void 0,(function*(){return!1}))}closeSticky(){return h(this,void 0,void 0,(function*(){yield this.sdk.ready}))}}var v=i(2712),f=i(5942),y=i(5572),p=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{d(r.next(t))}catch(t){s(t)}}function o(t){try{d(r.throw(t))}catch(t){s(t)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}d((r=r.apply(t,e||[])).next())}))};class g{constructor(t,e){this.gp=t,this.sdk=e,this.hasIntegratedAuth=!0,this.isExternalLinksAllowed=!1,this.isSecretCodeAuthAvailable=!1,this._hasAuthModal=!0,this.isLogoutAvailable=!1,this.type=f.z.Y8,this.socialNetworks=v.FU,this.hasAccountLinkingFeature=!1,this.isSupportsRemoteVariables=!1,this.isSupportsCloudSaves=!0}get isSupportsImageUploading(){return this.gp.player.isLoggedIn}getSDK(){return this.sdk}getNativeSDK(){return this.sdk.y8Sdk}requestPermissions(){return p(this,void 0,void 0,(function*(){return y.VK}))}uploadImage({file:t}){return this.sdk.uploadImage(t)}getVariables(){return p(this,void 0,void 0,(function*(){return{}}))}}class m{constructor(t){this.sdk=t,this.isSupportsShare=!0,this.isSupportsNativeShare=!1,this.isSupportsNativePosts=!1,this.isSupportsNativeInvite=!1,this.isSupportsNativeCommunityJoin=!1,this.canJoinCommunity=!1,this.isSupportShareParams=!0}get shareParams(){return this.sdk.shareParams}share(t){return Promise.resolve(!1)}post(t){return Promise.resolve(!1)}invite(t){return Promise.resolve(!1)}getCommunityLink(t){return t}joinCommunity(){return Promise.resolve(!1)}addShareParamsToUrl(t,e){return this.sdk.addShareParamsToUrl(t,e)}makeShareUrl(t){return this.sdk.makeShareUrl(t)}getShareParam(t){return this.sdk.getShareParam(t)}}var k=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{d(r.next(t))}catch(t){s(t)}}function o(t){try{d(r.throw(t))}catch(t){s(t)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}d((r=r.apply(t,e||[])).next())}))};class w{constructor(t){this.sdk=t,this.isSupportsSubscriptions=!1,this.isSupportsPayments=!1,this.isServerValidation=!1,this.isNeedAuthorizeBeforePurchase=!1,this.isOneTimeSubscription=!1}mapProducts(t,e){return k(this,void 0,void 0,(function*(){return e}))}consumeAllExpired(t,e,i){return k(this,void 0,void 0,(function*(){}))}fetchPurchases(){return k(this,void 0,void 0,(function*(){return{payload:{},purchases:[]}}))}purchase(t){return k(this,void 0,void 0,(function*(){return{}}))}consume(t){return k(this,void 0,void 0,(function*(){return{}}))}subscribe(t,e){return k(this,void 0,void 0,(function*(){return{}}))}unsubscribe(t,e){return k(this,void 0,void 0,(function*(){return{}}))}}var S=i(9),P=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{d(r.next(t))}catch(t){s(t)}}function o(t){try{d(r.throw(t))}catch(t){s(t)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}d((r=r.apply(t,e||[])).next())}))};class b{constructor(t){this.sdk=t}get y8Analytics(){return this.sdk.y8Sdk.Analytics.custom_event}hit(t){return P(this,void 0,void 0,(function*(){}))}goal(t,e){return P(this,void 0,void 0,(function*(){this.y8Analytics(t,e)}))}setVisitParams(t){}}var I=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{d(r.next(t))}catch(t){s(t)}}function o(t){try{d(r.throw(t))}catch(t){s(t)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}d((r=r.apply(t,e||[])).next())}))};class A{constructor(t){this.sdk=t,this.isLocal=!1}set(t,e){return I(this,void 0,void 0,(function*(){yield this.sdk.ready,this.sdk.y8Sdk.api("user_data/submit","POST",{key:t,value:JSON.stringify(e)})}))}get(t){return I(this,void 0,void 0,(function*(){yield this.sdk.ready;const e=(0,s._)();return this.sdk.y8Sdk.api("user_data/retrieve","POST",{key:t},(t=>{try{e.done(JSON.parse((null==t?void 0:t.jsondata)||"null"))}catch(t){e.done(null)}})),e.ready}))}}var _=i(2231),x=i(2665),C=i(3357);function U(t){return e=this,i=void 0,n=function*(){const[,e]=yield Promise.all([t.setupStorage([]),t.fetchConfig()]),i=new d(t.gp,e);yield i.init();const r=new x.Z(t.gp.projectId),n=new _.Z(`gs-db-project-${t.gp.projectId}`),{progressSaveFormat:s}=e.platformConfig,{isPlatformSave:a}=(0,C.q)(s);a&&t.gp._storage.replaceStorages([new A(i),n,r]);const o=new c(i);return{adsAdapter:new l(i),appAdapter:new S.Z,playerAdapter:o,platformAdapter:new g(t.gp,i),socialsAdapter:new m(i),paymentsAdapter:new w(i),projectConfig:e,analyticsCounters:[new b(i)]}},new((r=void 0)||(r=Promise))((function(t,s){function a(t){try{d(n.next(t))}catch(t){s(t)}}function o(t){try{d(n.throw(t))}catch(t){s(t)}}function d(e){var i;e.done?t(e.value):(i=e.value,i instanceof r?i:new r((function(t){t(i)}))).then(a,o)}d((n=n.apply(e,i||[])).next())}));var e,i,r,n}}}]);